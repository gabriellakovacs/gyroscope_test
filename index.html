<!doctype html>
<html>
<head>
    <title>gyroscope-test</title>
    <style>

    body {
        margin: 0;
        padding: 0;
    }

    html {
        overflow: hidden;
    }
    </style>

</head>
<body>
    <p id="alpha"></p>
    <p id="beta"></p>
    <p id="gamma"></p>
    <canvas id="canvas"></canvas>

    <script>
    var canvas = document.getElementById('canvas');
    var c = canvas.getContext('2d');

    var viewportW = window.innerWidth;
    var viewportH = window.innerHeight;

    canvas.width = viewportW;
    canvas.height = viewportH;
    

    c.fillStyle = "#0055ff";
    c.fillRect(0,viewportH/2,viewportW,viewportH);

    function Point (x, y){

               this.x = x;
               this.y = y;
           }

    function Line (slope, p){
        this.slope = slope;
        this.constant = p.y - slope * p.x;
    }

    Line.prototype.getpY = function(pX) {
        return pX * this.slope + this.constant;

    };   



    function drawQuadrangle (p1, p2, p3, p4, color){
        c.fillStyle = color;
        c.beginPath();
        c.moveTo(p1.x, p1.y);
        c.lineTo(p2.x, p2.y);
        c.lineTo(p3.x, p3.y);
        c.lineTo(p4.x, p4.y);
        c.fill();
    }


    var center = new Point(viewportW/2, viewportH/2);



    window.ondeviceorientation = function(event) {

        c.fillStyle = "#ffffff";
        c.fillRect(0,0,viewportW,viewportH);

        alpha = Math.round(event.alpha);
        beta = Math.round(event.beta);
        gamma = Math.round(event.gamma);

        var rotatedline = new Line(alpha, center);

        document.getElementById("alpha").innerHTML = alpha;
        
        document.getElementById("gamma").innerHTML = "p1 (0, " + rotatedline.getpY(0) + ")  p2 (" + viewportW + ", " + rotatedline.getpY(viewportW) + ") p3 (" + viewportW + ", " + viewportH + ") p4 ( 0, " +  viewportH + ")";

        


        var p1 = new Point(0, rotatedline.getpY(0));
        var p2 = new Point(viewportW, rotatedline.getpY(viewportW));
        var p3 = new Point(viewportW, viewportH);
        var p4 = new Point(0, viewportH);

        drawQuadrangle(p1, p2, p3, p4, "#0055ff");
    }


    </script>
</body>
</html>